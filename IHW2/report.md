# ИДЗ #2
## **Калашников Егор Игоревич БПИ226**

### **Вариант:** 26

### **Работа выполнена на 8 баллов**

**Условие:** Задача об инвентаризации по книгам. После нового года в библиотеке университета обнаружилась пропажа каталога. После поиска и наказания, виноватых ректор дал указание восстановить каталог силами студентов. Фонд библиотека представляет собой прямоугольное помещение, в котором находится M рядов по N шкафов по K книг в каждом шкафу. Требуется создать многопроцессное приложение, составляющее каталог по информации, поступающей от каждого из студентов, проверяющих местоположение книг.

## Решение на 4-5 баллов.

### Алгоритмы и структуры данных:
- Есть структура `Book`. В классе ней содержится информация о книге: ее id, номер ряда, номер шкафа и номер позиции в шкафу. Так же есть два булевых статуса, один показывает, есть ли книга, второй - проверена ли это книга. Помимо этого в каждой книге содержится **POSIX семафор**, не допускающий чтобы одновременно книга не провяралсь двумя и более студентами. 
- Есть класс `Student`. В нём содержится id студента, и скорость проверки книги этого студента - разные студенты проверяют с разной скоростью.
- Методы для генерации книг и студентов. Книги генерируются в вектор книг `library`, статус отвечающий за то, взята книга или находится на месте генерируется рандомно с вероятностью 60% что взята. Студенты генерируются в векторе `students`, скорость проверки студента генерируется рандомно - от 2 до 5 сек.
### Сценарий:
- Пользователь вводит количество студентов в терминале.
- Генерируется библиотека и вектор студентов.
- Запускаются дочерние процессы студентов, которые будут проверять книги до тех пор, пока все книги не будут проверены.
- Благодаря семафору, книга не проверяется одновременно 2 и более студентами.
- На экран выводится каталог проверки книги.
- Когда студенты проверят все книги, процессы завершатся а семафоры удалятся.
- ### Инструкция по запуску:
1) В терминале линукс перейти в каталог с файлом `main.cpp`;
2) Компиляция: прописать в терминале команду `g++ main.cpp -o main`;
3) Запуск: прописать в терминале команду `./main <k>`, где k - количество студентов-процессов.
4) Поскольку студенты могут долго проверять все книги, для преждевременного завершения достаточно нажать `CTRL+C`.

## Решение на 6-7 баллов.
Все тоже самое, только используем неименованные семафоры **UNIX SYSTEM V**, и при помощи разделяемой памяти происходит обмен между родительским и дочерними процессами.
### Инструкция по запуску: все тоже самое.

## Решение на 8 баллов
- Разделил на решение на 6-7 баллов на две программы - `library.cpp` и `student.cpp`. 
- Первая программа генерирует библиотеку основным процессом и при помощи разделяемой памяти передает указатель на книги программе студента. Работает до тех пор пока все книги не будут проверены.
- Программа студента делает все тоже самое что и в прошлых решениях и работает до тех пор, пока не будут проверены все книги.
### Инструкция по запуску:
1) В терминале линукс перейти в каталог с файлами `.cpp`;
2) Компиляция: прописать в терминале команды `g++ library.cpp -o library` и `g++ student.cpp -o student`;
3) Запуск: прописать в терминале команду `./library`, где k - количество студентов-процессов. Потом в другом окне запустить `./student`;
4) Поскольку студенты могут долго проверять все книги, для преждевременного завершения достаточно нажать `CTRL+C`.
